<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="maldipickr">
<title>Import data from Bruker MALDI Biotyper • maldipickr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Import data from Bruker MALDI Biotyper">
<meta property="og:description" content="maldipickr">
<meta property="og:image" content="https://clavellab.github.io/maldipickr/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">maldipickr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/dereplicate-bruker-maldi-biotyper-spectra.html">Dereplicate Bruker MALDI Biotyper spectra</a>
    <a class="dropdown-item" href="../articles/import-data-from-bruker-maldi-biotyper.html">Import data from Bruker MALDI Biotyper</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <h6 class="dropdown-header" data-toc-skip>Releases</h6>
    <a class="dropdown-item" href="https://clavellab.github.io/maldipickr/news/index.html#maldipickr-130">Version 1.3.0</a>
    <a class="dropdown-item" href="https://clavellab.github.io/maldipickr/news/index.html#maldipickr-120">Version 1.2.0</a>
    <a class="dropdown-item" href="https://clavellab.github.io/maldipickr/news/index.html#maldipickr-111">Version 1.1.1</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../news/index.html">Changelog</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ClavelLab/maldipickr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Import data from Bruker MALDI Biotyper</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ClavelLab/maldipickr/blob/HEAD/vignettes/import-data-from-bruker-maldi-biotyper.Rmd" class="external-link"><code>vignettes/import-data-from-bruker-maldi-biotyper.Rmd</code></a></small>
      <div class="d-none name"><code>import-data-from-bruker-maldi-biotyper.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ClavelLab/maldipickr" class="external-link">maldipickr</a></span><span class="op">)</span></span></code></pre></div>
<!-- WARNING - This vignette is generated by {fusen} from dev/import-data.Rmd: do not edit by hand -->
<!-- Run this 'development' chunk -->
<!-- Store every call to library() that you need to explore your functions -->
<!--
 You need to run the 'description' chunk in the '0-dev_history.Rmd' file before continuing your code there.

If it is the first time you use {fusen}, after 'description', you can directly run the last chunk of the present file with inflate() inside.
-->
<!-- 
 Store your dataset in a directory named "inst/" at the root of your project.
 Use it for your tests in this Rmd thanks to `pkgload::load_all()` to make it available
and `system.file()` to read it in your examples.

- There already is a dataset in the "inst/" directory to be used in the examples below
-->
<p>The matrix-assisted laser desorption/ionization-time-of-flight
(MALDI-TOF) technology is coupled with mass spectrometry in the Bruker
MALDI Biotyper device in order to identify microorganisms. The device
generates two types of data:</p>
<ol style="list-style-type: decimal">
<li>A report of the identification using its proprietary database of
mass spectrum projections (MSPs).</li>
<li>The raw mass spectrometry data.</li>
</ol>
<p>The following vignette describe how to streamline the import of these
two types of data into R using the <a href="https://github.com/ClavelLab/maldipickr" class="external-link"><code>{maldipickr}</code></a>
package</p>
<div class="section level2">
<h2 id="importing-generated-reports-from-the-bruker-maldi-biotyper-device">Importing generated reports from the Bruker MALDI Biotyper
device<a class="anchor" aria-label="anchor" href="#importing-generated-reports-from-the-bruker-maldi-biotyper-device"></a>
</h2>
<div class="section level3">
<h3 id="importing-a-single-report">Importing a single report<a class="anchor" aria-label="anchor" href="#importing-a-single-report"></a>
</h3>
<p>The Bruker MALDI Biotyper generates a report via the Compass software
summarizing the identification of the microorganisms using its internal
database. While the file is separated by semi-colons, it contains no
headers. The report has many columns in a <em>wide</em> format to
describe the ten hits when identification is feasible, or only a few
when no identification was possible. All-in-all, this makes the table
import into R and its manipulation relatively painful.</p>
<p>Below is an example of an import of a single Bruker MALDI Biotyper
report into a <a href="https://tibble.tidyverse.org" class="external-link"><code>{tibble}</code></a>. By
default, only the best hit of each colony is reported. All hits can be
reported as well, in the <em>long</em> format
(<code>long_format = TRUE</code>), for further explorations with the <a href="https://tidyverse.tidyverse.org/" class="external-link"><code>{tidyverse}</code></a>
suite.</p>
<!--
Create a chunk for the core of the function

- The chunk needs to be named `function` at least
- It contains the code of a documented function
- The chunk can also be named `function-my_median` to make it easily
findable in your Rmd
- Let the `@examples` part empty, and use the next `examples` chunk instead to present reproducible examples

After inflating the template

-  This function code will automatically be added in a new file in the "R/" directory
-->
<!--
Create a chunk with an example of use for your function

- The chunk needs to be named `examples` at least
- It contains working examples of your function
- The chunk is better be named `examples-my_median` to be handled
correctly when inflated as a vignette

After inflating the template

-  This example will automatically be added in the '@examples' part of our function above in the "R/" directory
- This example will automatically be added in the vignette created from this Rmd template
-->
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get a example Bruker report</span></span>
<span><span class="va">biotyper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"biotyper.csv"</span>, package <span class="op">=</span> <span class="st">"maldipickr"</span><span class="op">)</span></span>
<span><span class="co"># Import the report as a tibble</span></span>
<span><span class="va">report_tibble</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_biotyper_report.html">read_biotyper_report</a></span><span class="op">(</span><span class="va">biotyper</span><span class="op">)</span></span>
<span><span class="co"># Display the tibble</span></span>
<span><span class="va">report_tibble</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 8</span></span></span>
<span><span class="co">#&gt;   name    sample_name hit_rank bruker_quality bruker_species        bruker_taxid</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> targetA <span style="color: #BB0000;">NA</span>                 1 -              not reliable identif…           <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> targetB <span style="color: #BB0000;">NA</span>                 1 +++            Escherichia coli               562</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> targetC <span style="color: #BB0000;">NA</span>                 1 +++            Kosakonia cowanii           <span style="text-decoration: underline;">208</span>223</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: bruker_hash &lt;chr&gt;, bruker_log &lt;dbl&gt;</span></span></span></code></pre></div>
<!--
Create a chunk with a test of use for your function

- The chunk needs to be named `tests` at least
- It contains working tests of your function
- The chunk is better be named `tests-my_median` to be handled
correctly when inflated as a vignette

After inflating the template

-  This test code will automatically be added in the "tests/testthat/" directory
-->
</div>
<div class="section level3">
<h3 id="importing-multiple-reports">Importing multiple reports<a class="anchor" aria-label="anchor" href="#importing-multiple-reports"></a>
</h3>
<p>During large-scale analysis, batches of identification are run and
can easily be imported using the <code>read_many_biotyper_reports</code>
function along with their custom-made metadata.</p>
<p>Below is an example of such usage, where one report was artificially
extended into multiple reports.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List of Bruker MALDI Biotyper reports</span></span>
<span><span class="va">reports_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"biotyper.csv"</span>, <span class="st">"biotyper.csv"</span>, <span class="st">"biotyper.csv"</span><span class="op">)</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"maldipickr"</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Read the list of reports and combine them in a single tibble</span></span>
<span><span class="fu"><a href="../reference/read_many_biotyper_reports.html">read_many_biotyper_reports</a></span><span class="op">(</span></span>
<span>  <span class="va">reports_paths</span>,</span>
<span>  report_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"first"</span>, <span class="st">"second"</span>, <span class="st">"third"</span><span class="op">)</span>,</span>
<span>  <span class="co"># Additional metadata below are passed to dplyr::mutate</span></span>
<span>  growth_temperature <span class="op">=</span> <span class="fl">37.0</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 × 10</span></span></span>
<span><span class="co">#&gt;   name          original_name sample_name hit_rank bruker_quality bruker_species</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> first_targetA targetA       <span style="color: #BB0000;">NA</span>                 1 -              not reliable …</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> first_targetB targetB       <span style="color: #BB0000;">NA</span>                 1 +++            Escherichia c…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> first_targetC targetC       <span style="color: #BB0000;">NA</span>                 1 +++            Kosakonia cow…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> second_targe… targetA       <span style="color: #BB0000;">NA</span>                 1 -              not reliable …</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> second_targe… targetB       <span style="color: #BB0000;">NA</span>                 1 +++            Escherichia c…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> second_targe… targetC       <span style="color: #BB0000;">NA</span>                 1 +++            Kosakonia cow…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> third_targetA targetA       <span style="color: #BB0000;">NA</span>                 1 -              not reliable …</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> third_targetB targetB       <span style="color: #BB0000;">NA</span>                 1 +++            Escherichia c…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span> third_targetC targetC       <span style="color: #BB0000;">NA</span>                 1 +++            Kosakonia cow…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: bruker_taxid &lt;dbl&gt;, bruker_hash &lt;chr&gt;, bruker_log &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   growth_temperature &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="importing-spectra-from-the-bruker-maldi-biotyper-device">Importing spectra from the Bruker MALDI Biotyper device<a class="anchor" aria-label="anchor" href="#importing-spectra-from-the-bruker-maldi-biotyper-device"></a>
</h2>
<p>Other than the identification reports, the Bruker MALDI Biotyper
device outputs the raw data used for the identification (if not the
database) in the form of mass spectra. Thankfully, the <a href="https://strimmerlab.github.io/software/maldiquant/" class="external-link"><code>{MALDIquant}</code></a>
and <a href="https://cran.r-project.org/package=readBrukerFlexData" class="external-link"><code>{readBrukerFlexData}</code></a>
packages help users import and manipulate these data in R.</p>
<div class="section level3">
<h3 id="importing-multiple-spectra-from-a-directory-hierarchy">Importing multiple spectra from a directory hierarchy<a class="anchor" aria-label="anchor" href="#importing-multiple-spectra-from-a-directory-hierarchy"></a>
</h3>
<p>However, when the Bruker MALDI Biotyper device produces
<code>acqus</code> files (instead of the native <code>acqu</code>
files), the <a href="https://rdrr.io/cran/readBrukerFlexData/man/readBrukerFlexDir.html" class="external-link"><code>readBrukerFlexDir()</code></a>
function from the <a href="https://cran.r-project.org/package=readBrukerFlexData" class="external-link"><code>{readBrukerFlexData}</code></a>
package will fail with the following error message:</p>
<pre><code>Error in .readAcquFile(fidFile = fidFile, verbose = verbose) :
File ‘/data/maldi_dir/targetA/0_D10/1/1SLin/acqu’ doesn't exists!</code></pre>
<p>The following <a href="https://clavellab.github.io/maldipickr/reference/import_biotyper_spectra.html"><code>import_biotyper_spectra()</code></a>)
function used in the example below circumvent this error by creating a
symbolic link and conveniently helps removing calibration samples.</p>
<p>The toy dataset bundled with this package is a subset of a dataset in
the <a href="https://github.com/sgibb/MALDIquantExamples" class="external-link"><code>{MALDIquantExamples}</code></a>
package and consist here of six spectra: * 1 replicate of species 1 * 2
replicates of species 2 * 3 replicates of species 3</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get an example directory of six Bruker MALDI Biotyper spectra</span></span>
<span><span class="va">directory_biotyper_spectra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>  <span class="st">"toy-species-spectra"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"maldipickr"</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Import the six spectra</span></span>
<span><span class="va">spectra_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_biotyper_spectra.html">import_biotyper_spectra</a></span><span class="op">(</span><span class="va">directory_biotyper_spectra</span><span class="op">)</span></span>
<span><span class="co"># Display the list of spectra</span></span>
<span><span class="va">spectra_list</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; S4 class type            : MassSpectrum        </span></span>
<span><span class="co">#&gt; Number of m/z values     : 20882               </span></span>
<span><span class="co">#&gt; Range of m/z values      : 1962.222 - 20146.522</span></span>
<span><span class="co">#&gt; Range of intensity values: 2.4e+02 - 3.608e+04 </span></span>
<span><span class="co">#&gt; Memory usage             : 337.062 KiB         </span></span>
<span><span class="co">#&gt; Name                     : species1.G2         </span></span>
<span><span class="co">#&gt; File                     : /home/runner/.cache/R/renv/library/maldipickr-8ce40efa/R-4.3/x86_64-pc-linux-gnu/maldipickr/toy-species-spectra/species1/0_G2/1/1SLin/fid</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; S4 class type            : MassSpectrum        </span></span>
<span><span class="co">#&gt; Number of m/z values     : 20882               </span></span>
<span><span class="co">#&gt; Range of m/z values      : 1962.222 - 20146.522</span></span>
<span><span class="co">#&gt; Range of intensity values: 1.82e+02 - 1.006e+04</span></span>
<span><span class="co">#&gt; Memory usage             : 337.062 KiB         </span></span>
<span><span class="co">#&gt; Name                     : species2.E11        </span></span>
<span><span class="co">#&gt; File                     : /home/runner/.cache/R/renv/library/maldipickr-8ce40efa/R-4.3/x86_64-pc-linux-gnu/maldipickr/toy-species-spectra/species2/0_E11/1/1SLin/fid</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; S4 class type            : MassSpectrum        </span></span>
<span><span class="co">#&gt; Number of m/z values     : 20882               </span></span>
<span><span class="co">#&gt; Range of m/z values      : 1962.222 - 20146.522</span></span>
<span><span class="co">#&gt; Range of intensity values: 3.25e+02 - 2.115e+04</span></span>
<span><span class="co">#&gt; Memory usage             : 337.062 KiB         </span></span>
<span><span class="co">#&gt; Name                     : species2.E12        </span></span>
<span><span class="co">#&gt; File                     : /home/runner/.cache/R/renv/library/maldipickr-8ce40efa/R-4.3/x86_64-pc-linux-gnu/maldipickr/toy-species-spectra/species2/0_E12/1/1SLin/fid</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; S4 class type            : MassSpectrum        </span></span>
<span><span class="co">#&gt; Number of m/z values     : 20882               </span></span>
<span><span class="co">#&gt; Range of m/z values      : 1961.215 - 20135.904</span></span>
<span><span class="co">#&gt; Range of intensity values: 1.94e+02 - 2.055e+04</span></span>
<span><span class="co">#&gt; Memory usage             : 337.062 KiB         </span></span>
<span><span class="co">#&gt; Name                     : species3.F7         </span></span>
<span><span class="co">#&gt; File                     : /home/runner/.cache/R/renv/library/maldipickr-8ce40efa/R-4.3/x86_64-pc-linux-gnu/maldipickr/toy-species-spectra/species3/0_F7/1/1SLin/fid</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]</span></span>
<span><span class="co">#&gt; S4 class type            : MassSpectrum        </span></span>
<span><span class="co">#&gt; Number of m/z values     : 20882               </span></span>
<span><span class="co">#&gt; Range of m/z values      : 1961.215 - 20135.904</span></span>
<span><span class="co">#&gt; Range of intensity values: 1.6e+02 - 1.814e+04 </span></span>
<span><span class="co">#&gt; Memory usage             : 337.062 KiB         </span></span>
<span><span class="co">#&gt; Name                     : species3.F8         </span></span>
<span><span class="co">#&gt; File                     : /home/runner/.cache/R/renv/library/maldipickr-8ce40efa/R-4.3/x86_64-pc-linux-gnu/maldipickr/toy-species-spectra/species3/0_F8/1/1SLin/fid</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]</span></span>
<span><span class="co">#&gt; S4 class type            : MassSpectrum        </span></span>
<span><span class="co">#&gt; Number of m/z values     : 20882               </span></span>
<span><span class="co">#&gt; Range of m/z values      : 1961.215 - 20135.904</span></span>
<span><span class="co">#&gt; Range of intensity values: 1.59e+02 - 1.449e+04</span></span>
<span><span class="co">#&gt; Memory usage             : 337.062 KiB         </span></span>
<span><span class="co">#&gt; Name                     : species3.F9         </span></span>
<span><span class="co">#&gt; File                     : /home/runner/.cache/R/renv/library/maldipickr-8ce40efa/R-4.3/x86_64-pc-linux-gnu/maldipickr/toy-species-spectra/species3/0_F9/1/1SLin/fid</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="evaluate-the-quality-of-the-spectra">Evaluate the quality of the spectra<a class="anchor" aria-label="anchor" href="#evaluate-the-quality-of-the-spectra"></a>
</h3>
<p>Once the spectra are imported, the <a href="https://clavellab.github.io/maldipickr/reference/check_spectra.html"><code>check_spectra()</code></a>
function can easily assess whether all the spectra in the list are not
empty, of the same length and correspond to profile data. If some
spectra do not satisfy these criteria, the function will exit with a
warning and indicate the faulty spectra. Either way, the function
outputs a list of logical vectors (<code>TRUE</code> or
<code>FALSE</code>) indicating whether each of the spectra are empty
(<code>is_empty</code>), of an odd length
(<code>is_outlier_length</code>) or not a profile spectra
(<code>is_not_regular</code>).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get an example directory of six Bruker MALDI Biotyper spectra</span></span>
<span><span class="va">directory_biotyper_spectra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>  <span class="st">"toy-species-spectra"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"maldipickr"</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Import the six spectra</span></span>
<span><span class="va">spectra_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_biotyper_spectra.html">import_biotyper_spectra</a></span><span class="op">(</span><span class="va">directory_biotyper_spectra</span><span class="op">)</span></span>
<span><span class="co"># Display the list of checks, with FALSE where no anomaly is detected</span></span>
<span><span class="fu"><a href="../reference/check_spectra.html">check_spectra</a></span><span class="op">(</span><span class="va">spectra_list</span><span class="op">)</span></span>
<span><span class="co">#&gt; $is_empty</span></span>
<span><span class="co">#&gt; [1] FALSE FALSE FALSE FALSE FALSE FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $is_outlier_length</span></span>
<span><span class="co">#&gt; [1] FALSE FALSE FALSE FALSE FALSE FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $is_not_regular</span></span>
<span><span class="co">#&gt; [1] FALSE FALSE FALSE FALSE FALSE FALSE</span></span>
<span><span class="co"># The overall sanity can be checked with Reduce</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="va">any</span>, <span class="fu"><a href="../reference/check_spectra.html">check_spectra</a></span><span class="op">(</span><span class="va">spectra_list</span><span class="op">)</span><span class="op">)</span> <span class="co"># Should be FALSE</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Charlie Pauvert, Thomas Clavel.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
